var ModalPopupsDefaults={shadow:!0,shadowSize:5,shadowColor:"#333333",backgroundColor:"#CCCCCC",borderColor:"#999999",titleBackColor:"#C1D2E7",titleFontColor:"#15428B",popupBackColor:"#C7D6E9",popupFontColor:"black",footerBackColor:"#C1D2E7",footerFontColor:"#15428B",okButtonText:"OK",yesButtonText:"Yes",noButtonText:"No",cancelButtonText:"Cancel",fontFamily:"Verdana,Arial",fontSize:"9pt"},ModalPopups={Init:function(){},SetDefaults:function(b){b=b||{};ModalPopupsDefaults.shadow=null!=b.shadow?b.shadow:
ModalPopupsDefaults.shadow;ModalPopupsDefaults.shadowSize=null!=b.shadowSize?b.shadowSize:ModalPopupsDefaults.shadowSize;ModalPopupsDefaults.shadowColor=null!=b.shadowColor?b.shadowColor:ModalPopupsDefaults.shadowColor;ModalPopupsDefaults.backgroundColor=null!=b.backgroundColor?b.backgroundColor:ModalPopupsDefaults.backgroundColor;ModalPopupsDefaults.borderColor=null!=b.borderColor?b.borderColor:ModalPopupsDefaults.borderColor;ModalPopupsDefaults.okButtonText=null!=b.okButtonText?b.okButtonText:ModalPopupsDefaults.okButtonText;
ModalPopupsDefaults.yesButtonText=null!=b.yesButtonText?b.yesButtonText:ModalPopupsDefaults.yesButtonText;ModalPopupsDefaults.noButtonText=null!=b.noButtonText?b.noButtonText:ModalPopupsDefaults.noButtonText;ModalPopupsDefaults.cancelButtonText=null!=b.cancelButtonText?b.cancelButtonText:ModalPopupsDefaults.cancelButtonText;ModalPopupsDefaults.titleBackColor=null!=b.titleBackColor?b.titleBackColor:ModalPopupsDefaults.titleBackColor;ModalPopupsDefaults.titleFontColor=null!=b.titleFontColor?b.titleFontColor:
ModalPopupsDefaults.titleFontColor;ModalPopupsDefaults.popupBackColor=null!=b.popupBackColor?b.popupBackColor:ModalPopupsDefaults.popupBackColor;ModalPopupsDefaults.popupFontColor=null!=b.popupFontColor?b.popupFontColor:ModalPopupsDefaults.popupFontColor;ModalPopupsDefaults.footerBackColor=null!=b.footerBackColor?b.footerBackColor:ModalPopupsDefaults.footerBackColor;ModalPopupsDefaults.footerFontColor=null!=b.footerFontColor?b.footerFontColor:ModalPopupsDefaults.footerFontColor;ModalPopupsDefaults.fontFamily=
null!=b.fontFamily?b.fontFamily:ModalPopupsDefaults.fontFamily;ModalPopupsDefaults.fontSize=null!=b.fontSize?b.fontSize:ModalPopupsDefaults.fontSize},Alert:function(b,a,d,c){c=c||{};a||(a="Alert");c.buttons="ok";c.okButtonText=null!=c.okButtonText?c.okButtonText:ModalPopupsDefaults.okButtonText;a=ModalPopups._createAllLayers(b,a,d,c);a[4].innerHTML=d;ModalPopups._styleAllLayers(b,c,a)},Confirm:function(b,a,d,c){c=c||{};a||(a="Confirm");c.buttons="yes,no";c.yesButtonText=null!=c.yesButtonText?c.yesButtonText:
ModalPopupsDefaults.yesButtonText;c.noButtonText=null!=c.noButtonText?c.noButtonText:ModalPopupsDefaults.noButtonText;a=ModalPopups._createAllLayers(b,a,d,c);a[4].innerHTML=d;ModalPopups._styleAllLayers(b,c,a)},YesNoCancel:function(b,a,d,c){c=c||{};a||(a="YesNoCancel");c.buttons="yes,no,cancel";c.yesButtonText=null!=c.yesButtonText?c.yesButtonText:ModalPopupsDefaults.yesButtonText;c.noButtonText=null!=c.noButtonText?c.noButtonText:ModalPopupsDefaults.noButtonText;c.cancelButtonText=null!=c.cancelButtonText?
c.cancelButtonText:ModalPopupsDefaults.cancelButtonText;a=ModalPopups._createAllLayers(b,a,d,c);a[4].innerHTML=d;ModalPopups._styleAllLayers(b,c,a)},Prompt:function(b,a,d,c){c=c||{};a||(a="Prompt");c.buttons="ok,cancel";c.okButtonText=null!=c.okButtonText?c.okButtonText:"OK";c.cancelButtonText=null!=c.cancelButtonText?c.cancelButtonText:"Cancel";a=ModalPopups._createAllLayers(b,a,d,c);var g=a[4],r="";null!=c.width&&(r="width:95%;");d=d+"<br/>"+("<input type=text id='"+b+"_promptInput' value='' style='border: solid 1px #859DBE; "+
r+"'>");g.innerHTML=d;ModalPopups._styleAllLayers(b,c,a);ModalPopupsSupport.findControl(b+"_promptInput").focus()},GetPromptInput:function(b){return ModalPopupsSupport.findControl(b+"_promptInput")},GetPromptResult:function(b){return ModalPopupsSupport.findControl(b+"_promptInput")},GetCustomControl:function(b){return ModalPopupsSupport.findControl(b)},Indicator:function(b,a,d,c){c=c||{};a||(a="Indicator");null==c.buttons&&(c.buttons="");a=ModalPopups._createAllLayers(b,a,d,c);a[4].innerHTML=d;ModalPopups._styleAllLayers(b,
c,a)},Custom:function(b,a,d,c){c=c||{};a||(a="Custom");null==c.buttons?alert("buttons is a required parameter. ie: buttons: 'yes,no' or buttons: 'ok'.\nPossible buttons are yes, no, ok, cancel"):(a=ModalPopups._createAllLayers(b,a,d,c),a[4].innerHTML=d,ModalPopups._styleAllLayers(b,c,a))},Close:function(b){window.onresize=null;window.onscroll=null;document.body.removeChild(ModalPopupsSupport.findControl(b+"_background"));document.body.removeChild(ModalPopupsSupport.findControl(b+"_popup"));document.body.removeChild(ModalPopupsSupport.findControl(b+
"_shadow"))},Cancel:function(b){ModalPopups.Close(b)},_zIndex:1E4,_createAllLayers:function(b,a,d,c){d=ModalPopupsSupport.makeLayer(b+"_background",!0,null);var g=ModalPopupsSupport.makeLayer(b+"_popup",!0,null),r=ModalPopupsSupport.makeLayer(b+"_shadow",!0,null),e=ModalPopupsSupport.makeLayer(b+"_popupTitle",!0,g),s=ModalPopupsSupport.makeLayer(b+"_popupBody",!0,g),f=ModalPopupsSupport.makeLayer(b+"_popupFooter",!0,g),n=null!=c.okButtonText?c.okButtonText:ModalPopupsDefaults.okButtonText,q=null!=
c.yesButtonText?c.yesButtonText:ModalPopupsDefaults.yesButtonText,p=null!=c.noButtonText?c.noButtonText:ModalPopupsDefaults.noButtonText,k=null!=c.cancelButtonText?c.cancelButtonText:ModalPopupsDefaults.cancelButtonText,h=null!=c.onOk?c.onOk:'ModalPopups.Close("'+b+'");',l=null!=c.onYes?c.onYes:'ModalPopups.Close("'+b+'");',m=null!=c.onNo?c.onNo:'ModalPopups.Close("'+b+'");',t=null!=c.onCancel?c.onCancel:'ModalPopups.Close("'+b+'");';e.innerHTML="<table cellpadding='0' cellspacing='0' style='border: 0;' height='100%'><tr><td valign='middle'><b>"+
a+"</b></td></tr></table>";f.innerHTML="";c.fontFamily=null!=c.fontFamily?c.fontFamily:ModalPopupsDefaults.fontFamily;a=c.buttons.split(",");for(x in a)"ok"==a[x]&&(f.innerHTML+="<input name='"+b+"_okButton' id='"+b+"_okButton' type=button value='"+n+"' style='font-family:Verdana,Arial; font-size:8pt; border: solid 1px #859DBE; background-color: white; width:75px; height:20px; margin-right: 5px; margin-left: 5px;' onclick='"+h+"'/>"),"yes"==a[x]&&(f.innerHTML+="<input name='"+b+"_yesButton' id='"+
b+"_yesButton' type=button value='"+q+"' style='font-family:Verdana,Arial; font-size:8pt; border: solid 1px #859DBE; background-color: white; width:75px; height:20px; margin-right: 5px; margin-left: 5px;' onclick='"+l+"'/>"),"no"==a[x]&&(f.innerHTML+="<input name='"+b+"_noButton' id='"+b+"_noButton' type=button value='"+p+"' style='font-family:Verdana,Arial; font-size:8pt; border: solid 1px #859DBE; background-color: white; width:75px; height:20px; margin-right: 5px; margin-left: 5px;' onclick='"+
m+"'/>"),"cancel"==a[x]&&(f.innerHTML+="<input name='"+b+"_cancelButton' id='"+b+"_cancelButton' type=button value='"+k+"' style='font-family:Verdana,Arial; font-size:8pt; border: solid 1px #859DBE; background-color: white; width:75px; height:20px; margin-right: 5px; margin-left: 5px;' onclick='"+t+"'/>");a=[d,g,r,e,s,f];null!=c.autoClose&&setTimeout('ModalPopups.Close("'+b+'");',c.autoClose);return a},_styleAllLayers:function(b,a,d){var c=d[0],g=d[1],r=d[2],e=d[3],s=d[4],f=d[5];ModalPopups._zIndex+=
3;var n=ModalPopups._zIndex;a.borderColor=null!=a.borderColor?a.borderColor:ModalPopupsDefaults.borderColor;var q="display:inline; position:absolute; z-index: "+n+"; left:0px; top:0px; width:100%; height:100%; filter:alpha(opacity=70); opacity:0.7;";ModalPopupsSupport.isOlderIE()&&(q=ModalPopupsSupport.getViewportDimensions(),q="display:inline; position:absolute; z-index: 10; left:0px; top:0px; width:"+q.width+"px; height:"+q.height+"px; filter:alpha(opacity=70); opacity:0.7; overflow:hidden;");var p=
"display:inline; position:absolute; z-index: "+(n+1)+";",n="display:inline; position:absolute; z-index: "+(n+2)+"; background-color:white; color:black; border:solid 1px "+a.borderColor+"; padding:1px;";a.backgroundColor=null!=a.backgroundColor?a.backgroundColor:ModalPopupsDefaults.backgroundColor;q+=" background-color:"+a.backgroundColor+";";a.fontFamily=null!=a.fontFamily?a.fontFamily:ModalPopupsDefaults.fontFamily;a.fontSize=null!=a.fontSize?a.fontSize:ModalPopupsDefaults.fontSize;var k="position: absolute; font-family:"+
a.fontFamily+"; font-size:"+a.fontSize+"; padding: 5px; text-align:left;",h="position: absolute; font-family:"+a.fontFamily+"; font-size:"+a.fontSize+"; padding: 5px; text-align:left;",l="position: absolute; font-family:"+a.fontFamily+"; font-size:"+a.fontSize+"; padding: 5px; text-align:center;";ModalPopupsSupport.isIE?(e.style.cssText=k,s.style.cssText=h,f.style.cssText=l):(e.setAttribute("style",k),s.setAttribute("style",h),f.setAttribute("style",l));a.titleBackColor=null!=a.titleBackColor?a.titleBackColor:
ModalPopupsDefaults.titleBackColor;a.titleFontColor=null!=a.titleFontColor?a.titleFontColor:ModalPopupsDefaults.titleFontColor;a.popupBackColor=null!=a.popupBackColor?a.popupBackColor:ModalPopupsDefaults.popupBackColor;a.popupFontColor=null!=a.popupFontColor?a.popupFontColor:ModalPopupsDefaults.popupFontColor;a.footerBackColor=null!=a.footerBackColor?a.footerBackColor:ModalPopupsDefaults.footerBackColor;a.footerFontColor=null!=a.footerFontColor?a.footerFontColor:ModalPopupsDefaults.footerFontColor;
var k=k+(" background-color:"+a.titleBackColor+";"),k=k+(" color:"+a.titleFontColor+";"),h=h+(" background-color:"+a.popupBackColor+";"),h=h+(" color:"+a.popupFontColor+";"),l=l+(" background-color:"+a.footerBackColor+";"),l=l+(" color:"+a.footerFontColor+";"),m=0;ModalPopupsSupport.getLayerWidth(e.id)>m&&(m=ModalPopupsSupport.getLayerWidth(e.id));ModalPopupsSupport.getLayerWidth(s.id)>m&&(m=ModalPopupsSupport.getLayerWidth(s.id));ModalPopupsSupport.getLayerWidth(f.id)>m&&(m=ModalPopupsSupport.getLayerWidth(f.id));
var t=ModalPopupsSupport.getLayerHeight(e.id)+ModalPopupsSupport.getLayerHeight(s.id)+ModalPopupsSupport.getLayerHeight(f.id);a.width=null!=a.width?a.width:m+4;a.height=null!=a.height?a.height:t;m=ModalPopupsSupport.getLayerHeight(s.id);a.height>t&&(m=a.height-ModalPopupsSupport.getLayerHeight(e.id)-ModalPopupsSupport.getLayerHeight(f.id),h+=" height:"+m+"px;",t=ModalPopupsSupport.getLayerHeight(e.id)+m+ModalPopupsSupport.getLayerHeight(f.id));var k=k+" top:1px;",h=h+(" top:"+ModalPopupsSupport.getLayerHeight(e.id)+
"px;"),l=l+(" top:"+(ModalPopupsSupport.getLayerHeight(e.id)+m)+"px;"),k=k+(" width:"+(a.width-10)+"px;"),h=h+(" width:"+(a.width-10)+"px;"),l=l+(" width:"+(a.width-10)+"px;"),m=ModalPopupsSupport.getFrameWidth(),u=ModalPopupsSupport.getFrameHeight();a.height<t&&(a.height=t);a.top=null!=a.top?a.top:u/2-a.height/2;a.left=null!=a.left?a.left:m/2-a.width/2;k+=" left:1px;";h+=" left:1px;";l+=" left:1px;";n=a.width?n+(" width:"+a.width+"px;"):n+(" width:"+a.maxWidth+"px;");n=a.height?n+(" height:"+(a.height-
1)+"px;"):n+(" height:"+(t-1)+"px;");ModalPopupsSupport.isIE?(e.style.cssText=k,s.style.cssText=h,f.style.cssText=l):(e.setAttribute("style",k),s.setAttribute("style",h),f.setAttribute("style",l));a.shadow=null!=a.shadow?a.shadow:ModalPopupsDefaults.shadow;a.shadowSize=null!=a.shadowSize?a.shadowSize:ModalPopupsDefaults.shadowSize;a.shadow?(a.shadowSize=null!=a.shadowSize?a.shadowSize:ModalPopupsDefaults.shadowSize,a.shadowColor=null!=a.shadowColor?a.shadowColor:ModalPopupsDefaults.shadowColor,p+=
"background-color:"+a.shadowColor+";",p=a.width?p+(" width:"+a.width+"px;"):p+(" width:"+maxWidth+"px;"),p=a.height?p+(" height:"+(a.height-1)+"px;"):p+(" height:"+t+"px;")):p+=" display:none;";ModalPopupsSupport.isIE?(g.style.cssText=n,r.style.cssText=p,c.style.cssText=q):(g.setAttribute("style",n),r.setAttribute("style",p),c.setAttribute("style",q));ModalPopupsSupport.isOlderIE()?(q=ModalPopupsSupport.getViewportDimensions(),c.innerHTML="<div><iframe style='z-index:-1; position:absolute; top:0;left:0 display:none; display/**/:block; position:absolute; filter:mask(); width:"+
q.width+"px; height:"+q.height+"px;' id='corr_bug_ie' src='../common/imgLay/spinner.gif'></iframe></div>"):ModalPopupsSupport.centerElement(document.getElementById(b+"_background"),0,!0);ModalPopupsSupport.centerElement(document.getElementById(b+"_popup"),0,!1);a.shadow&&ModalPopupsSupport.centerElement(document.getElementById(b+"_shadow"),a.shadowSize,!1);a.loadTextFile=null!=a.loadTextFile?a.loadTextFile:"";""!=a.loadTextFile&&ModalPopups._loadTextFile(b,a,d,a.loadTextFile);window.onresize=function(){ModalPopupsSupport.centerElement(document.getElementById(b+
"_background"),0,!0);ModalPopupsSupport.centerElement(document.getElementById(b+"_popup"),0,!1);a.shadow&&ModalPopupsSupport.centerElement(document.getElementById(b+"_shadow"),a.shadowSize,!1)};window.onscroll=function(){ModalPopupsSupport.centerElement(document.getElementById(b+"_background"),0,!0);ModalPopupsSupport.centerElement(document.getElementById(b+"_popup"),0,!1);a.shadow&&ModalPopupsSupport.centerElement(document.getElementById(b+"_shadow"),a.shadowSize,!1)}},_loadTextFile:function(b,a,
d,c){var g=ModalPopupsSupport.getXmlHttp();g.open("GET",c,!0);g.onreadystatechange=function(){if(4==g.readyState){var c=g.responseText.replace("\r\n","<br>").replace("\n\r","<br>").replace("\n","<br>").replace("\r","<br>"),e="<div style='overflow-y: scroll; position:absolute; top:5px; left:5px; height:"+(a.height-65)+"px; width:"+(a.width-10)+"px;'>",e=e+c+"</div>";ModalPopups.GetCustomControl(b+"_popupBody").innerHTML=e;a.loadTextFile="";ModalPopups._styleAllLayers(b,a,d)}};g.send(null)}},ModalPopupsSupport=
{isIE:function(){return window.ActiveXObject?!0:!1},isOlderIE:function(){var b=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return-1<b&&7>b?!0:!1},makeLayer:function(b,a,d){a=document.createElement("div");a.id=b;d?d.appendChild(a):document.body.appendChild(a);return a},deleteLayer:function(b){(b=findLayer(b))&&document.body.removeChild(b)},findLayer:function(b){return document.all?document.all[b]:document.getElementById(b)},
findControl:function(b,a){return document.all?document.all[b]:document.getElementById(b)},getLayerHeight:function(b){return gh=document.getElementById(b).offsetHeight},getLayerWidth:function(b){return gw=document.getElementById(b).offsetWidth},getViewportDimensions:function(){var b=0,a=0;self.innerHeight?(b=window.innerHeight,a=window.innerWidth):document.documentElement&&document.documentElement.clientHeight?(b=document.documentElement.clientHeight,a=document.documentElement.clientWidth):document.body&&
(b=document.body.clientHeight,a=document.body.clientWidth);return{height:parseInt(b,10),width:parseInt(a,10)}},getScrollXY:function(){var b=0,a=0;"number"==typeof window.pageYOffset?(a=window.pageYOffset,b=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(a=document.body.scrollTop,b=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(a=document.documentElement.scrollTop,b=document.documentElement.scrollLeft);
return[b,a]},centerElement:function(b,a,d){var c=ModalPopupsSupport.getViewportDimensions(),g=0==c.width?50:parseInt((c.width-b.offsetWidth)/2,10),r=0==c.height?50:parseInt((c.height-b.offsetHeight)/2,10),e=ModalPopupsSupport.getScrollXY();d||(b.style.left=g+a+"px");b.style.top=r+a+e[1]+"px";c;g;r},readFile:function(b,a){var d=getXmlHttp(),c=b+"?r="+Math.random();d.open("GET",c,!0);d.onreadystatechange=function(){4==d.readyState&&(a.innerHTML=d.responseText)};d.send(null)},getFrameWidth:function(){var b=
document.documentElement.clientWidth;if(self.innerWidth)b=self.innerWidth;else if(document.documentElement&&document.documentElement.clientWidth)b=document.documentElement.clientWidth;else if(document.body)b=document.body.clientWidth;else return;return b},getFrameHeight:function(){var b=document.documentElement.clientHeight;if(self.innerWidth)b=self.innerHeight;else if(document.documentElement&&document.documentElement.clientWidth)b=document.documentElement.clientHeight;else if(document.body)b=document.body.clientHeight;
else return;return b},getXmlHttp:function(){var b;try{b=new XMLHttpRequest}catch(a){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){return alert("Your browser does not support AJAX!"),!1}}}return b}};
